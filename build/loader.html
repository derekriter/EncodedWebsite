<!DOCTYPE html>
<html>
    <head>
        <title>Loading...</title>
    </head>
    <body>
        <script>
            async function getFile(name) {
                try {
                    const response = await fetch(name, {method: "GET"});
                    if(!response.ok) throw new Error(`Response status: ${response.status}`);
                    
                    return response.text();
                }
                catch(err) {console.log(err);}
            }
            
            /*
            domain.com/             index.enc.html
            domain.com/?t=sub/      sub/index.enc.html
            */
            
            const params = new URLSearchParams(new URL(window.document.URL).search);
            let target = "/";
            
            if(params.has("t")) target = params.get("t");
            if(target.endsWith("/")) target += "index.enc.html";
            else if(target.indexOf(".") === -1) target += "/index.enc.html";
            
            getFile(target).then((raw) => {
                let file = atob(raw);
                let parser = new DOMParser();
                
                let proc = parser.parseFromString(file, "text/html");
                document.head.innerHTML = proc.head.innerHTML;
                document.body.innerHTML += proc.body.innerHTML;
            }).catch((err) => {
                console.log(err);
            });
        </script>
    </body>
</html>
